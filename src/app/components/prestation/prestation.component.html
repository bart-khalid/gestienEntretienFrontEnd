<p-toast [style]="{marginTop: '30%'}"></p-toast>
<div class="row">
  <div class="col-md-8">

    <!-- Buttons to Add a Prestation -->
    <div class="card bg-transparent" id="cardToCenter">
    <div class="card-body">
      <div class="row">
        <div class="col-md-2" style="color: rgba(147,212,191,0.92)"><label for="ajouter"><h2><strong> Ajouter :</strong></h2> </label></div>
      <div class="col-md-5">
        <button class="btn btn-block btn-primary" pButton icon="pi pi-plus" id="ajouter" (click)="showDialogToAdd()" label="Prestation Interne"></button>
      </div>
      <div class="col-md-5">
        <button class="btn btn-block btn-primary" pButton icon="pi pi-plus" id="ajouter" (click)="showDialogToAddE()" label="Prestation Externe"></button>
      </div>
    </div>
    </div>
  </div>

    <!-- First dialog to add a prestation Interne -->
    <p-dialog header="Prestation Interne Details" [(visible)]="displayDialog" [focusOnShow]="false"  showEffect="fade" [modal]="true"  [style]="{width: '660px'}" >
      <div class="ui-g ui-fluid" *ngIf="prestataionInterne" >
        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="typeEntretienn" style="color: #00aeef"><strong>Type Entretien :</strong> </label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform"  >
            <p-dropdown id="typeEntretienn" formControlName="typeEntretien" [options]="entretiens" [(ngModel)]="prestataionInterne.typeEntretien" [filter]="true"></p-dropdown>
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error"  *ngIf="(userform.controls['typeEntretien'].touched &&!userform.controls['typeEntretien'].dirty  || userform.controls['typeEntretien'].value=='Choisir un type')"
                       text="Veuillez choisir un type"></p-message>
          </div>
        </div>


        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="date" style="color: #00aeef"><strong>Date :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform"  >
            <input pInputText id="date" formControlName="date"  type="date" [(ngModel)]="prestataionInterne.date" />
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="userform.controls['date'].hasError('required') && (userform.controls['date'].dirty || userform.controls['date'].touched) "
                       text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="reclameer" style="color: #00aeef"><strong>Cette prestation est reclamée ?</strong></label>
          </div>
          <div class="ui-g-2">
            <p-checkbox [(ngModel)]="prestataionInterne.reclamed" id="reclameer" [binary]="true"></p-checkbox> &nbsp; &nbsp;
            <label for="bonL" style="color: #00aeef"><strong>{{prestataionInterne.reclamed}}</strong></label>
          </div>
          <div class="ui-g-3"></div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12" *ngIf="prestataionInterne.reclamed">
          <div class="ui-g-3">
            <label for="refReclamationn" style="color: #00aeef">Réclamation associée :</label>
          </div>
          <div class="ui-g-5">
            <p-dropdown [filter]="true"  [options]="reclamations" [(ngModel)]="prestataionInterne.referenceReclamation"  id="refReclamationn"></p-dropdown>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" severity="error" HIDDEN="true" text="Veuillez choisir une réclamation"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="codeAgent" style="color: #00aeef"><strong>Agent :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform"  >
            <p-dropdown [options]="agents" formControlName="agent" [(ngModel)]="prestataionInterne.codeAgent"  id="codeAgent"></p-dropdown>
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="(userform.controls['agent'].touched &&!userform.controls['agent'].dirty  || userform.controls['agent'].value=='Choisir un agent')"
                       text="Veuillez choisir un agent"></p-message>
          </div>
        </div>


      </div>
      <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
          <button type="button"  pButton icon="pi pi-save" [disabled]="!userform.valid"  (click)="save()" label="Enregistrer"></button>
        </div>
      </p-footer>
    </p-dialog>

    <!-- Second dialog to add a prestation Externe -->
    <p-dialog header="Prestation Externe Details" [(visible)]="displayDialogE" [focusOnShow]="true"  showEffect="fade" [modal]="true"  [style]="{width: '660px'}">
      <div class="ui-g ui-fluid" *ngIf="prestataionExterne" >
        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="typeEntretien" style="color: #00aeef"><strong>Type Entretien :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform1"  >
            <p-dropdown id="typeEntretien" formControlName="typeEntretienn" [options]="entretiens" [(ngModel)]="prestataionExterne.typeEntretien" [filter]="true"></p-dropdown>
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="(userform1.controls['typeEntretienn'].touched &&!userform1.controls['typeEntretienn'].dirty  || userform1.controls['typeEntretienn'].value=='Choisir un type')"
                       text="Veuillez choisir un type"></p-message>
          </div>
        </div>


        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="dateP" style="color: #00aeef"><strong>Date :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform1"  >
            <input pInputText id="dateP" formControlName="datee" type="date" [(ngModel)]="prestataionExterne.date" />
            </div>

          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="userform1.controls['datee'].hasError('required') && (userform1.controls['datee'].dirty || userform1.controls['datee'].touched) "
                       text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="reclamer" style="color: #00aeef"><strong>Cette prestation est déja réclamée ?</strong></label>
          </div>
          <div class="ui-g-5">
            <p-checkbox [(ngModel)]="prestataionExterne.reclamed" id="reclamer" [binary]="true"></p-checkbox> &nbsp; &nbsp;
            <label for="bonL" style="color: #00aeef"><strong>{{prestataionExterne.reclamed}}</strong></label>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12" *ngIf="prestataionExterne.reclamed">
          <div class="ui-g-3">
            <label for="refReclamation" style="color: #00aeef">Réclamation associée :</label>
          </div>
          <div class="ui-g-5">
            <p-dropdown  [options]="reclamations" [(ngModel)]="prestataionExterne.referenceReclamation"  id="refReclamation"></p-dropdown>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="nomPres" style="color: #00aeef"><strong>Nom Prestataire :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform1"  >
            <input type="text" formControlName="nomprestataire" [(ngModel)]="prestataionExterne.nomPrestataire" pInputText id="nomPres">
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="userform1.controls['nomprestataire'].hasError('required') && (userform1.controls['nomprestataire'].dirty || userform1.controls['nomprestataire'].touched) "
                       text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="montant" style="color: #00aeef"><strong>Montant Facture :</strong></label>
          </div>
          <div class="ui-g-5">
            <div class="form-group" [formGroup]="userform1"  >
            <input type="number" formControlName="montant" [(ngModel)]="prestataionExterne.montantFac" pInputText id="montant">
          </div>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" *ngIf="userform1.controls['montant'].hasError('required') && (userform1.controls['montant'].dirty || userform1.controls['montant'].touched) "
                       text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="bonc" style="color: #00aeef"><strong>Cette Prestation à un Bon Commande ?</strong></label>
          </div>
          <div class="ui-g-5">
            <p-checkbox [(ngModel)]="prestataionExterne.bonCommande" id="bonC" [binary]="true"></p-checkbox> &nbsp; &nbsp;
            <label for="bonL" style="color: #00aeef"><strong>{{prestataionExterne.bonCommande}}</strong></label>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <!-- items of bon Commande -->
        <div  *ngIf="prestataionExterne.bonCommande" style="align-items: center; align-content: center; text-align: center">

        <div class="ui-g-12" >
          <div class="ui-g-3">
            <label for="numbonc" style="color: #00aeef">Numero Bon Commande :</label>
          </div>
          <div class="ui-g-5">
            <input type="number" pInputText [(ngModel)]="prestataionExterne.presBonCommande.numeroBonCommande" id="numbonC" >
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="dateBonc" style="color: #00aeef">Date Bon Commande :</label>
          </div>
          <div class="ui-g-5">
            <input pInputText id="dateBonc"  type="date" [(ngModel)]="prestataionExterne.presBonCommande.dateBonCommande" />
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

          <div class="ui-g-12">
            <div class="ui-g-3">
              <label for="montantC" style="color: #00aeef">Montant :</label>
            </div>
            <div class="ui-g-5">
              <input type="number" pInputText  [(ngModel)]="prestataionExterne.presBonCommande.montant" id="montantC" >
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

          <div class="ui-g-12">
            <div class="ui-g-3">
              <label for="nomP" style="color: #00aeef">Nom Prestataire :</label>
            </div>
            <div class="ui-g-5">
              <input type="text" pInputText  [(ngModel)]="prestataionExterne.presBonCommande.nomPrestataire" id="nomP" >
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

        </div>
        <!-- fin items of bon Commande -->

        <div class="ui-g-12">
          <div class="ui-g-3">
            <label for="bonL" style="color: #00aeef"><strong>Prestation A Un Bon Livraison ?</strong></label>
          </div>
          <div class="ui-g-5">
            <p-checkbox [(ngModel)]="prestataionExterne.bonLivraison" id="bonL" [binary]="true"></p-checkbox> &nbsp; &nbsp;
            <label for="bonL" style="color: #00aeef"><strong>{{prestataionExterne.bonLivraison}}</strong></label>
          </div>
          <div class="ui-g-4">
            <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
          </div>
        </div>

        <!-- items of bon Livrraison -->

        <div  *ngIf="prestataionExterne.bonLivraison" style="align-items: center; align-content: center; text-align: center">

          <div class="ui-g-12" >
            <div class="ui-g-3">
              <label for="numbonL" style="color: #00aeef">Numero Bon Livraison :</label>
            </div>
            <div class="ui-g-5">
              <input type="number" pInputText [(ngModel)]="prestataionExterne.presBonLivraison.numeroBonLivraison" id="numbonL" >
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

          <div class="ui-g-12">
            <div class="ui-g-3">
              <label for="dateBonL" style="color: #00aeef">Date Bon Livraison :</label>
            </div>
            <div class="ui-g-5">
              <input pInputText type="date" [(ngModel)]="prestataionExterne.presBonLivraison.dateBonLivraison" id="dateBonL" />
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

          <div class="ui-g-12">
            <div class="ui-g-3">
              <label for="montantL" style="color: #00aeef">Montant :</label>
            </div>
            <div class="ui-g-5">
              <input type="number" pInputText  [(ngModel)]="prestataionExterne.presBonLivraison.montant" id="montantL" >
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

          <div class="ui-g-12">
            <div class="ui-g-3">
              <label for="nomPL" style="color: #00aeef">Nom Prestataire :</label>
            </div>
            <div class="ui-g-5">
              <input type="text" pInputText  [(ngModel)]="prestataionExterne.presBonLivraison.nomPrestataire" id="nomPL" >
            </div>
            <div class="ui-g-4">
              <p-message severity="error" HIDDEN="true" text="Champ Obligatoire"></p-message>
            </div>
          </div>

        </div>

        <!-- fin items of bon Commande -->


      </div>
      <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
          <button type="button" [disabled]="!userform1.valid" pButton icon="pi pi-save"  (click)="save()" label="Enregistrer"></button>
        </div>
      </p-footer>
    </p-dialog>




  </div>

  <div class="col-md-4">

    <p-table [columns]="cols" [value]="foundedReclamations" [resizableColumns]="true" [autoLayout]="true" [paginator]="true" [rows]="5">
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns">
            {{col.header}}
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
          <td *ngFor="let col of columns">
            {{rowData[col.field]}}
          </td>
        </tr>
      </ng-template>
    </p-table>


  </div>
</div>

